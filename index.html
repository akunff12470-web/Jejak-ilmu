<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Jejak Terkunci</title>
<style>
body {
  margin: 0;
  background: black;
  color: white;
  overflow: hidden;
  font-family: Arial, sans-serif;
}
#game {
  position: relative;
  width: 100vw;
  height: 100vh;
  background: #050505;
}
.player {
  width: 20px;
  height: 20px;
  background: white;
  position: absolute;
}
.key { width: 15px; height: 15px; background: gold; position: absolute; }
.motorKey { width: 18px; height: 18px; background: cyan; position: absolute; display: none; }
.exit { width: 40px; height: 40px; background: green; position: absolute; display: none; }

.ghost {
  width: 25px;
  height: 25px;
  position: absolute;
}
.red { background: red; }
.shadow { background: purple; opacity: 0.6; }
.guard { background: darkred; }

#ui { position: fixed; top: 10px; left: 10px; }
#jumpscare {
  display: none;
  position: fixed;
  inset: 0;
  background: black;
  color: red;
  font-size: 60px;
  justify-content: center;
  align-items: center;
  z-index: 999;
}
</style>
</head>

<body>

<div id="game">
  <div class="player" id="player"></div>

  <div class="ghost red" id="ghost1"></div>
  <div class="ghost shadow" id="ghost2"></div>
  <div class="ghost guard" id="ghost3" style="display:none"></div>

  <div class="motorKey" id="motorKey"></div>
  <div class="exit" id="exit"></div>
</div>

<div id="ui">
‚ù§Ô∏è <span id="life">5</span><br>
üîë <span id="keys">0</span>/10<br>
üèçÔ∏è <span id="motor">‚ùå</span>
</div>

<div id="jumpscare">üëª</div>

<audio id="ambience" loop autoplay>
  <source src="https://www.soundjay.com/nature/crickets-1.mp3">
</audio>
<audio id="scream">
  <source src="https://www.soundjay.com/human/scream-01.mp3">
</audio>

<script>
const player = document.getElementById("player");
const g1 = document.getElementById("ghost1");
const g2 = document.getElementById("ghost2");
const g3 = document.getElementById("ghost3");
const motorKey = document.getElementById("motorKey");
const exit = document.getElementById("exit");
const jumpscare = document.getElementById("jumpscare");
const scream = document.getElementById("scream");

let x=50,y=50, life=5, keys=0, hasMotor=false;
let g1x=300,g1y=200, g2x=600,g2y=300, g3x=400,g3y=100;

player.style.left=x+"px"; player.style.top=y+"px";

for(let i=0;i<10;i++){
  let k=document.createElement("div");
  k.className="key";
  k.style.left=Math.random()*(innerWidth-40)+"px";
  k.style.top=Math.random()*(innerHeight-40)+"px";
  game.appendChild(k);
}

motorKey.style.left="80%"; motorKey.style.top="10%";
exit.style.left="90%"; exit.style.top="80%";

document.addEventListener("keydown",e=>{
  if(e.key==="w")y-=10;
  if(e.key==="s")y+=10;
  if(e.key==="a")x-=10;
  if(e.key==="d")x+=10;
  player.style.left=x+"px"; player.style.top=y+"px";
  checkKey(); checkMotor(); checkExit();
});

setInterval(()=>{
  // Ghost merah selalu kejar
  g1x+=(x-g1x)*0.02; g1y+=(y-g1y)*0.02;
  g1.style.left=g1x+"px"; g1.style.top=g1y+"px";

  // Ghost bayangan random
  if(Math.random()<0.02){
    g2x=Math.random()*innerWidth;
    g2y=Math.random()*innerHeight;
  }
  g2.style.left=g2x+"px"; g2.style.top=g2y+"px";

  // Ghost penjaga aktif akhir
  if(keys>=10){
    g3.style.display="block";
    g3x+=(x-g3x)*0.03; g3y+=(y-g3y)*0.03;
    g3.style.left=g3x+"px"; g3.style.top=g3y+"px";
  }

  if(hitCheck(g1x,g1y)||hitCheck(g2x,g2y)||hitCheck(g3x,g3y)){
    hit();
  }
},30);

function hitCheck(gx,gy){
  return Math.abs(x-gx)<20 && Math.abs(y-gy)<20;
}

function checkKey(){
  document.querySelectorAll(".key").forEach(k=>{
    if(Math.abs(x-k.offsetLeft)<20 && Math.abs(y-k.offsetTop)<20){
      k.remove(); keys++;
      document.getElementById("keys").innerText=keys;
      if(keys===10){ alert("Semua kunci didapat!"); motorKey.style.display="block"; }
    }
  });
}

function checkMotor(){
  if(!hasMotor && Math.abs(x-motorKey.offsetLeft)<20){
    hasMotor=true; motorKey.style.display="none";
    document.getElementById("motor").innerText="‚úîÔ∏è";
    alert("Kunci motor didapat! Cari pintu keluar!");
    exit.style.display="block";
  }
}

function checkExit(){
  if(hasMotor && Math.abs(x-exit.offsetLeft)<30){
    alert("ENDING: KABUR\nKamu berhasil keluar!");
    location.reload();
  }
}

function hit(){
  life--; document.getElementById("life").innerText=life;
  scream.play();
  jumpscare.style.display="flex";
  setTimeout(()=>jumpscare.style.display="none",500);
  x=50;y=50;
  if(life<=0){ alert("ENDING: TERKUNCI SELAMANYA"); location.reload(); }
}
</script>
</body>
</html>
